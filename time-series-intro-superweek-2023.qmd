---
title: "Time-Series Analysis"
subtitle: "Important Concepts, Handy Techniques, and Some Cautionary Tales"
author: "Tim Wilson<br>Superweek 2023"
format:
  revealjs: 
    theme: [moon, includes/theme-mod.scss]
    footer: \@tgwilson | tim@gilliganondata.com
    transition: zoom
    parallax-background-image: images/bg-mallards.jpeg
    parallax-background-size: "2048px 1152px"
    background-transition: fade
title-slide-attributes:
  data-background-image: images/saliris.jpeg
  data-background-size: cover
  data-background-opacity: "0.2"
execute:
  echo: false
  dev: "png"
editor: visual
---

# Let's think about time. {background-color="#5A3B727C"}

```{r setup}
source("includes/setup.R")
```

## {background-color="#5A3B727C"}

:::: {.columns .v-center-container}
::: {.column width="40%"}
[This presentation]{.h2-chars}

::: {.fragment}
[40 minutes]{.h1-chars}
:::

:::

::: {.column width="60%"}
![DALL-E 2: "A puppy delivering a presentation that has a line chart on a slide, digital art"](images/puppy_presentation.png)
:::
::::

## {background-color="#5A3B727C"}

:::: {.columns .v-center-container}
::: {.column width="40%"}
[Superweek]{.h2-chars}

::: {.fragment}
[5 days]{.h1-chars}
:::

:::

::: {.column width="60%"}
![DALL-E 2: "A puppy attending the Superweek analytics conference, digital art"](images/puppy_superweek.png)
:::
::::

## {background-color="#5A3B727C"}

:::: {.columns .v-center-container}
::: {.column width="40%"}
[My last job]{.h2-chars}

::: {.fragment}
[5 years]{.h1-chars}
:::

:::

::: {.column width="60%"}
![DALL-E 2: "A puppy working as marketing analyst, digital art"](images/puppy_analyst.png)
:::
::::

## {background-color="#5A3B727C"}

:::: {.columns .v-center-container}
::: {.column width="40%"}
[Yehoshua's intros]{.h2-chars}
:::

::: {.column width="60%"}
::: {.fragment}
![DALL-E 2: "A puppy with eyes that look like the infinity symbol, digital art"](images/puppy_infinity.png)
:::
:::
::::

# "Time" is tricky. {background-color="#5A3B727C"}

# But it's at the [core of what we do]{.underline}. {background-color="#5A3B727C"}

## It rarely looks [quite]{.underline} like this {background-color="#5A3B727C" transition="fade"}

::: {.v-center-container}
```{r base-ts}
#| dev.args: !expr 'list(bg="transparent")'
#| fig.height: 6

ggplot(get_ts(), aes(x = date, y = value)) +
  geom_line(color = s_line_1, linewidth = 1.1) +
  labs(y = "Sessions") +
  scale_y_continuous(expand = c(0,0), limits = ~ c(0, max(.x) * 1.1), label = comma) +
  theme_main

```
:::

## It often has a weekly cycle to it {background-color="#5A3B727C" transition="fade"}

::: {data-id="plot1"}
```{r trending}
#| dev.args: !expr 'list(bg="transparent")'
#| fig.height: 6

ggplot(get_ts(base = 10000, start = Sys.Date()-45, week_season = TRUE), aes(x = date, y = value)) +
  geom_line(color = s_line_1, linewidth = 1.1) +
  labs(y = "Sessions") +
  scale_y_continuous(expand = c(0,0), limits = ~ c(0, max(.x) * 1.1), label = comma) +
  theme_main

```
:::

## And it may have a trend to it {background-color="#5A3B727C" transition="fade"}

```{r}
#| dev.args: !expr 'list(bg="transparent")'
#| fig.height: 6

ggplot(get_ts(base = 50000, start = Sys.Date()-45, week_season = TRUE, trend = 0.5), aes(x = date, y = value)) +
  geom_line(color = s_line_1, linewidth = 1.1) +
  labs(y = "Sessions") +
  scale_y_continuous(expand = c(0,0), limits = ~ c(0, max(.x) * 1.1), label = comma) +
  theme_main

```

## {background-color="#5A3B727C"}

:::: {.columns .v-center-container}
::: {.column width="60%"}
![DALL-E 2: "A puppy running a linear regression on a computer, digital art"](images/puppy_chalkboard.png)
:::

::: {.column width="40%"}
[Let's think about [statistics]{.underline}]{.h1-chars}
:::
::::

# Statistics is all about estimating a [population]{.underline} from a [sample]{.underline}. {background-color="#3F2D767C"}

{{< include _time-sample-population.qmd >}}

{{< include _stationarity.qmd >}}

{{< include _first-differences.qmd >}}

{{< include _time-series-decomposition.qmd >}}

{{< include _causal-impact.qmd >}}

# Let's summarize

## What we covered

Blew your mind about what the population is 

Discussed stationarity

Explored first differences: avoiding seeing correlation in time-series data when there is not any 

Looked at time-series decomposition 

Briefly covered Bayesian structural time-series (with and without covariates)

# Time...is hard.

## Learning more...

Hyndman book.

# Thank you!
