---
title: "Time-Series Analysis"
subtitle: "Important Concepts, Handy Techniques, and Some Cautionary Tales"
author: "Tim Wilson<br>Superweek 2023"
format:
  revealjs: 
    theme: [moon, includes/theme-mod.scss]
    footer: \@tgwilson | tim@gilliganondata.com
    transition: zoom
    parallax-background-image: images/bg-mallards.jpeg
    parallax-background-size: "2100px 900px"
    background-transition: fade
title-slide-attributes:
  data-background-image: images/saliris.jpeg
  data-background-size: cover
  data-background-opacity: "0.2"
execute:
  echo: false
  dev: "png"
editor: visual
---

# Let's think about time.

## 

::: columns
::: {.column width="40%"}
[The Bowhead Whale Can Live for Up to 200 Years]{style="font-size: 1.8em; text-align: right;"}
:::

::: {.column width="60%"}
![DALL-E 2: "A bowhead whale with a long gray beard and spectacles, digital art"](images/whale-beard.png)
:::
:::

# Let's think about statistics.

# Statistics is all about estimating a population from a sample

## When we evaluate historical data, it's a snapshot in time

We think it's about finding "the truth," but what is "the population?"

(Show diagram of time).

## All (Most) of Our Data Is Time-Series

It rarely looks *quite* like this.

```{r setup}
#| dev.args: !expr 'list(bg="transparent")'

source("includes/setup.R")

ggplot(get_ts(), aes(x = date, y = value)) +
  geom_line(color = s_line_1, linewidth = 1.1) +
  labs(y = "Sessions") +
  scale_y_continuous(expand = c(0,0), limits = ~ c(0, max(.x) * 1.1), label = comma) +
  theme_main

```

## It often has a weekly cycle to it

This is "seasonality" that we'll get to in a bit.

```{r trending}
#| dev.args: !expr 'list(bg="transparent")'

ggplot(get_ts(base = 10000, week_season = TRUE), aes(x = date, y = value)) +
  geom_line(color = s_line_1, linewidth = 1.1) +
  labs(y = "Sessions") +
  scale_y_continuous(expand = c(0,0), limits = ~ c(0, max(.x) * 1.1), label = comma) +
  theme_main

```

## And it may have a trend to it

```{r}
#| dev.args: !expr 'list(bg="transparent")'

ggplot(get_ts(base = 50000, week_season = TRUE, trend = 0.5), aes(x = date, y = value)) +
  geom_line(color = s_line_1, linewidth = 1.1) +
  labs(y = "Sessions") +
  scale_y_continuous(expand = c(0,0), limits = ~ c(0, max(.x) * 1.1), label = comma) +
  theme_main
```

# "Time" is tricky.

# But it's at the core of what we do.

{{< include _stationarity.qmd >}}
{{< include _first-differences.qmd >}}
{{< include _time-series-decomposition.qmd >}}
{{< include _causal-impact.qmd >}}




